# -*- coding: utf-8 -*-
"""
Created on Tue Mar 10 17:02:32 2015

@author: good-cat
"""

###--------------------------------------------------------###
###-------------------Initializations----------------------###
###--------------------------------------------------------###

import numpy as np

def gabor(Nx=20, Ny=20, K=1.0, X0=10,Y0=10, sigma_x=5.0, sigma_y=5.0, kx=1.0, ky=1.0, P=0.0):
    """ 
    The kernel for Gabor filter. Arguments: data (2d-array).
    """

###--------------------------------------------------------###
###-------------------Possible errors----------------------###
###--------------------------------------------------------###
    

        
###--------------------------------------------------------###
###----------------------Main part-------------------------###
###--------------------------------------------------------###        
        
   
    x = np.linspace(0,Nx-1,Nx)
    y = np.linspace(0,Nx-1,Nx)
    
    X,Y = np.meshgrid(x,y)
    
    
    G = K*np.exp(-((X-X0)**2)/(2*sigma_x**2)-((Y-Y0)**2)/(2*sigma_y**2))*np.exp(1.0j*((kx*X+ky*Y)+P))
    
    return G

 
    
        
###--------------------------------------------------------###
###----------------------Testing part----------------------###
###--------------------------------------------------------###

def test_gabor():
    data = np.ones((10,10))
    z = gabor()*data  
    
    
    assert (type(z) == np.ndarray)
   # assert ((z.sum()<=data.sum()) and (z.sum()>=-data.sum()))
    

if __name__ == "__main__":
       
    test_gabor()
